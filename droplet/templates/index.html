<!DOCTYPE html>
<html>
<head>
    <title>Sensor Data Live Graph</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <h1>Sensor Data Live Graph</h1>
    <button id="captureButton">Capture Data</button>
    <div id="graph"></div>
    <div id="sensorData">
        <p id="temperature">Temperature: </p>
        <p id="humidity">Humidity: </p>
        <img id="capturedImage" src="" alt="Captured Image" style="display: none;" width="500" height="auto"/>
    </div>
    <script>
        document.getElementById('captureButton').addEventListener('click', function() {
            fetch('/api/capture', {method: 'POST'})
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    // Assuming we have an endpoint to fetch an entry by ID
                    fetch(`/api/entry/${data.id}`)
                        .then(response => response.json())
                        .then(entryData => {
                            document.getElementById('temperature').textContent = "Temperature: " + entryData.temperature + "Â°C";
                            document.getElementById('humidity').textContent = "Humidity: " + entryData.humidity + "%";
                            // Assuming the images are served from a static directory configured in Flask
                            document.getElementById('capturedImage').src = `/images/${entryData.image_filename}`;
                            document.getElementById('capturedImage').style.display = 'block';
                        })
                        .catch(error => console.error('Error fetching entry:', error));
                })
                .catch(error => console.error('Error capturing data:', error));
        });
        
        // JavaScript to update the graph in real-time
        // Add your existing or new Plotly graph code here
    </script>
</body>
</html>
